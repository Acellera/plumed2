DISTANCE LABEL=C1 ATOMS=0,1 COMPONENTS
DISTANCE LABEL=C1n ATOMS=0,1 COMPONENTS NUMERICAL_DERIVATIVES
COORDINATION LABEL=coord GROUPA=1-4,14-16 GROUPB=100 NN=6 MM=12 R_0=0.5 D_0=0 
COMBINE ...
  LABEL=X ARG=C1.x,C1.y,C1.z COEFFICIENTS=1.0,1.0,1.0 POWERS=2.0,2.0,2.0 PERIODIC=0,1
   NUMERICAL_DERIVATIVES
... COMBINE
COMBINE ...
  LABEL=Xn ARG=C1.x,C1.y,C1.z COEFFICIENTS=1.0,1.0,1.0 POWERS=2.0,2.0,2.0 PERIODIC=0,1
   NUMERICAL_DERIVATIVES
... COMBINE

#MATHEVAL ...
#  LABEL=Y ARG=C1.x,C1.y FUNC=atan(y/x) PERIODIC=-1.5707963267949,+1.5707963267949
#  NUMERICAL_DERIVATIVES
#... MATHEVAL

DUMPDERIVATIVES ARG=X,Xn FILE=derivX
DUMPDERIVATIVES ARG=C1,C1n FILE=derivC1

#MOVINGRESTRAINT ...
#  ARG=X
#  STRIDE=1
#    KAPPA0=100.0 
#    AT0=0.0
#    AT1=6.0
#    STEP0=0
#    STEP1=4000
#  LABEL=rest
#... MOVINGRESTRAINT

PRINT ...
  STRIDE=5
  ARG=C1.x,C1.y,C1.z,X,coord # ,rest.Energy
  FILE=COLVAR
... PRINT

# DEBUG logActivity

FLUSH STRIDE=100

ENDPLUMED

commenti

F::COMBINE LABEL=X ARG=C1.x,C1.y,C1.z COEFFICIENTS=1.0,1.0,1.0 POWERS=2.0,2.0,2.0
F::COMBINE LABEL=Y ARG=X COEFFICIENTS=1.0 POWERS=0.5
#RESTRAINT  KAPPA=10.0 ARG=Y STRIDE=5 AT=1.0
