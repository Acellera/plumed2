/**
\page belfast-1 Belfast tutorial: Analyzing CVs

\section Aims

\section belfast-1-lo Learning Outcomes

Once this tutorial is completed students will:

\section Resources

The tarball for this project contains the following files:

\section Instructions

PLUMED2 is a library that can be accessed by multiple codes adding a relatively simple and well documented interface.
Once PLUMED is installed you can run a plumed executable that can be used for multiple purposes:

\verbatim
plumed --help 
\endverbatim

some of the listed options report about the plumed available functionalities, other can be used to tell plumed to do something:
from analysing a trajectory to patch the source code of a MD code and so on. All the commands have further options that can
be seen using plumed command --help, i.e.:

\verbatim
plumed driver --help
\endverbatim

In the following we are going to see how to write an input file for plumed2 that can be used to analyse a trajectory.

\subsection Units A note on units
By default the PLUMED inputs and outputs quantities in the following units:

- Energy - kJ/mol
- Length - nanometers
- Time - picoseconds

If you want to change these units you can do this using the \subpage UNITS keyword. 

\subsection introinput Introduction to the PLUMED input file

A typical input file for PLUMED input is composed by specification of one or more CVs, the printout frequency and a termination line.
Comments are denoted with a # and the termination of the input for PLUMED is marked with the keyword ENDPLUMED. Whatever it follows is ignored by PLUMED. You can introduce blank lines. They are not interpreted by PLUMED.

In the following input we will analyse the \ref DISTANCE between the two terminal carbons of a 16 residues peptide, and we will \ref PRINT the results
in file named COLVAR.

\verbatim
#my first plumed input:
DISTANCE ATOMS=2,253 LABEL=e2edist

#printout frequency
PRINT ARG=e2edist STRIDE=1 FILE=COLVAR 

#endofinput 
ENDPLUMED
here I can write what I want it won't be read.
\endverbatim

Now we can use this simple input file to analyse the trajectory included in the RESOURCES:

\verbatim
plumed driver --plumed plumed.dat --ixyz trajectory-short.xyz --length-units 0.1
\endverbatim

NOTE: --length-units 0.1, xyz files, as well as pdb files, are in Angstrom.

You should have a file COLVAR, if you look at it (i.e. more COLVAR) the first two lines
should be:

\verbatim 
#! FIELDS time e2edist 
 0.000000 2.5613161
\endverbatim

NOTE: the first line of the file COLVAR tells you what is the content of each column.

In PLUMED2 the commands defined in the input files are executed in the same order in which they are written, this means that the
following input file is wrong:

\verbatim
#printout frequency
PRINT ARG=cvdist STRIDE=1 FILE=COLVAR 
#my first plumed input:
DISTANCE ATOMS=2,253 LABEL=e2edist
#endofinput 
ENDPLUMED
here I can write what I want it won't be read.
\endverbatim

Try to run it.

Sometimes, when calculating a collective variable, you may not want to use the positions of a number of atoms directly. Instead you may wish to use the position of a virtual atom whose position is generated based on the positions of a collection of other atoms. For example you might want to use the center of mass of a group of atoms (\ref COM):

Since PLUMED executes the input in order you need to define the new Virtual Atom before using it:

\verbatim

first: COM ATOMS=1,2,3,4,5,6
last: COM ATOMS=251-256

e2edist: DISTANCE ATOMS=2,253
comdist: DISTANCE ATOMS=first,last

PRINT ARG=e2edist,comdist STRIDE=1 FILE=COLVAR 

ENDPLUMED
\endverbatim

NOTE: an action (i.e. COM or DISTANCE here) can be either label using LABEL as we did before or as label: ACTION as we have just done here.

With the above input this is what happen inside PLUMED with a STRIDE=1:

1. calculates the position of the Virtual Atom 'first' as the \ref COM of atoms from 1 to 6;
2. calculates the position of the Virtual Atom 'last' as the \ref COM of atoms from 251 to 256;
3. calculates the distance between atoms 2 and 253 and saves it in 'e2edist';
4. calculates the distance between the two atoms 'first' and 'last' and saves it in 'comdist';
5. print the content of 'e2edist' and 'comdist' in the file COLVAR

In the above input we have used to different ways of writing the atoms used in \ref COM calculation:

1. ATOMS=1,2,3,4,5,6 is the explicit list of the atoms we need
2. ATOMS=251-256 is the range of atoms needed

ranges of atoms can be defined with a stride which can also be negative:

3. ATOMS=from,to:by (i.e.: 251-256:2)
4. ATOMS=to,from:-by (i.e.: 256-251:-2)

additional ways of writing atoms include the combination of the above and the possibility of reading GROMACS index files.

Now by plotting the content of the COLVAR file we can compare the behaviour in this trajectory of both the terminal carbons
as well as of the centre of masses of the terminal residues.

\verbatim
gnuplot
\endverbatim

What do you expect to see now by looking at the trajectory? Let's have a look at it

\verbatim
vmd template.pdb trajectory-short.xyz 
\endverbatim
 
Virtual atoms can be used in place of standard atoms everywhere an atom can be given as input, they can also be used together
with standard atoms. So for example we can analyse the \ref TORSION angle for a set of Virtual and Standard atoms:

\verbatim
first: COM ATOMS=1-6
last: COM ATOMS=251-256
cvtor: TORSION ATOMS=first,102,138,last

PRINT ARG=cvtor STRIDE=1 FILE=COLVAR 

ENDPLUMED
\endverbatim

The above CV don't look smart to learn something about the system we are looking at. In principle CV are used to reduce the complexity
of a system and look at a small number of properties that are enough to rationalise its behaviour. Now try to write a collective
variable that measures the Radius of Gyration of the system: \ref GYRATION.

NOTE: if what you need for one or more variables is a long list of atoms and not a virtual atoms one can use the keyword \ref GROUP.

\verbatim
ca: GROUP ATOMS=9,16,31,55,69,90,102,114,124,138,160,174,194,208,224,238
\endverbatim

Now 'ca' is not a virtual atom but a simple list of atoms.

\subsection multicol MULTICOLVAR

Many collective variables are often a 

\subsection analysis Analysis of Collective Variables



*/

link: @subpage belfast-1

description: This tutorial explains how to use plumed to analyze CVs


